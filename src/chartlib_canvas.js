!function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);var n=function(){function e(){}return e.prototype.changeBackground=function(e){document.getElementById("supercontenaire").style["background-color"]=e},e.prototype.creatVolBar=function(e,t,i,n,a,r,o){var s=e.dataGap*e.zoom,h=e.Y_mainSpace+e.Y_upperTextSpace,c=a.highestVolume-a.lowestVolume,l=h+5+e.Y_volumeSpace*(1-(e.data[r].volume-a.lowestVolume)/c),d=e.Y_volumeSpace;e.renderObj[t].getContext("2d").fillStyle=o,e.renderObj[t].getContext("2d").rect(i,l,s,d)},e.prototype.creatBar=function(e,t,i,n,a,r,o){var s=e.dataGap*e.zoom,h=a.highestPrice-a.lowestPrice,c=e.Y_upperTextSpace+e.Y_mainSpace*(1-(e.data[r].highest-a.lowestPrice)/h),l=e.Y_upperTextSpace+e.Y_mainSpace*(1-(e.data[r].lowest-a.lowestPrice)/h)-c,d=(e.Y_upperTextSpace,e.Y_mainSpace,e.data[r].average,a.lowestPrice,r>0&&e.data[r].average<e.data[r-1].average?"lower":"higher");e.renderObj[""+t+d].getContext("2d").globalCompositeOperation="destination-over",e.renderObj[""+t+d].getContext("2d").fillStyle=o[d],e.renderObj[""+t+d].getContext("2d").rect(i,c,s,l)},e.prototype.averageDot=function(e,t,i,n,a,r,o){var s=e.dataGap*e.zoom,h=a.highestPrice-a.lowestPrice,c=e.Y_upperTextSpace+e.Y_mainSpace*(1-(e.data[r].average-a.lowestPrice)/h);e.renderObj[""+t].getContext("2d").fillStyle=o,e.renderObj[""+t].getContext("2d").rect(i+s/2-1.25,c-1.25,2.5,2.5)},e.prototype.creatLine=function(e,t,i,n,a,r,o){if(r<e.dataLength-1){var s=e.dataGap*e.zoom,h=a.highestPrice-a.lowestPrice,c=e.Y_upperTextSpace+e.Y_mainSpace*(1-(e.data[r].average-a.lowestPrice)/h),l=e.Y_upperTextSpace+e.Y_mainSpace*(1-(e.data[r+1].average-a.lowestPrice)/h);e.renderObj[t].getContext("2d").strokeStyle=o,e.renderObj[t].getContext("2d").lineWidth=2,e.renderObj[t].getContext("2d").moveTo(i+s/2,c),e.renderObj[t].getContext("2d").lineTo(n+s/2,l)}},e.prototype.creatMovAv5d=function(e,t,i,n,a,r,o,s){var h=e.dataGap*e.zoom,c=r.highestPrice-r.lowestPrice,l=0,d=0;o<=3?(l=e.Y_upperTextSpace+e.Y_mainSpace*(1-(a/(o+1)-r.lowestPrice)/c),d=e.Y_upperTextSpace+e.Y_mainSpace*(1-((a+e.data[o+1].average)/(o+2)-r.lowestPrice)/c)):(l=e.Y_upperTextSpace+e.Y_mainSpace*(1-(a/5-r.lowestPrice)/c),d=e.Y_upperTextSpace+e.Y_mainSpace*(1-((a+e.data[o+1].average-e.data[o-4].average)/5-r.lowestPrice)/c)),e.renderObj.movingAverage5d.getContext("2d").lineWidth=2,e.renderObj.movingAverage5d.getContext("2d").strokeStyle=s,e.renderObj.movingAverage5d.getContext("2d").moveTo(i+h/2,l),e.renderObj.movingAverage5d.getContext("2d").lineTo(n+h/2,d)},e.prototype.creatMovAv20d=function(e,t,i,n,a,r,o,s){var h=e.dataGap*e.zoom,c=r.highestPrice-r.lowestPrice,l=0,d=0;o<=18?(l=e.Y_upperTextSpace+e.Y_mainSpace*(1-(a/(o+1)-r.lowestPrice)/c),d=e.Y_upperTextSpace+e.Y_mainSpace*(1-((a+e.data[o+1].average)/(o+2)-r.lowestPrice)/c)):(l=e.Y_upperTextSpace+e.Y_mainSpace*(1-(a/20-r.lowestPrice)/c),d=e.Y_upperTextSpace+e.Y_mainSpace*(1-((a+e.data[o+1].average-e.data[o-19].average)/20-r.lowestPrice)/c)),e.renderObj.movingAverage20d.getContext("2d").lineWidth=2,e.renderObj.movingAverage20d.getContext("2d").strokeStyle=s,e.renderObj.movingAverage20d.getContext("2d").moveTo(i+h/2,l),e.renderObj.movingAverage20d.getContext("2d").lineTo(n+h/2,d)},e.prototype.creatDonchian=function(e,t,i,n,a,r,o,s){var h,c,l,d,p,u,g,v=r.highestPrice-r.lowestPrice;function f(e,t,i){var n=[0,0];if("low"===e){n[0]=t[i-4].lowest;for(var a=5;a>=0;a--)n[0]>t[i-a].lowest&&(n[0]=t[i-a].lowest,n[1]=i-a)}else{n[0]=t[i-4].highest;for(a=5;a>=0;a--)n[0]<t[i-a].highest&&(n[0]=t[i-a].highest,n[1]=i-a)}return n}e.renderObj.donchianChannel.getContext("2d").globalAlpha=.3,o<=4?(p=e.data[o+1].lowest<a.lastLow?e.data[o+1].lowest:a.lastLow,u=e.data[o+1].highest>a.lastHigh?e.data[o+1].highest:a.lastHigh,h=e.Y_upperTextSpace+e.Y_mainSpace*(1-(a.lastLow-r.lowestPrice)/v),c=e.Y_upperTextSpace+e.Y_mainSpace*(1-(a.lastHigh-r.lowestPrice)/v),l=e.Y_upperTextSpace+e.Y_mainSpace*(1-(p-r.lowestPrice)/v),d=e.Y_upperTextSpace+e.Y_mainSpace*(1-(u-r.lowestPrice)/v),e.renderObj.donchianChannel.getContext("2d").fillStyle=s,e.renderObj.donchianChannel.getContext("2d").moveTo(i,h),e.renderObj.donchianChannel.getContext("2d").lineTo(i,c),e.renderObj.donchianChannel.getContext("2d").lineTo(n,d),e.renderObj.donchianChannel.getContext("2d").lineTo(n,l)):(o-a.lastLowIndex>4&&(g=f("low",e.data,o),a.lastLow=g[0],a.lastLowIndex=g[1]),o-a.lastHighIndex>4&&(g=f("high",e.data,o),a.lastHigh=g[0],a.lastHighIndex=g[1]),p=f("low",e.data,o+1)[0],u=f("high",e.data,o+1)[0],h=e.Y_upperTextSpace+e.Y_mainSpace*(1-(a.lastLow-r.lowestPrice)/v),c=e.Y_upperTextSpace+e.Y_mainSpace*(1-(a.lastHigh-r.lowestPrice)/v),l=e.Y_upperTextSpace+e.Y_mainSpace*(1-(p-r.lowestPrice)/v),d=e.Y_upperTextSpace+e.Y_mainSpace*(1-(u-r.lowestPrice)/v),e.renderObj.donchianChannel.getContext("2d").fillStyle=s,e.renderObj.donchianChannel.getContext("2d").moveTo(i,h),e.renderObj.donchianChannel.getContext("2d").lineTo(i,c),e.renderObj.donchianChannel.getContext("2d").lineTo(n,d),e.renderObj.donchianChannel.getContext("2d").lineTo(n,l))},e}(),a={chart:{line:{exist:!0,func:"creatLine",colour:"#000000",layer:7},bar:{exist:!0,func:"creatBar",colour:{higher:"#00FF00",lower:"#FF0000"},layer:2},average:{exist:!0,func:"averageDot",colour:"#000000",layer:4},volume:{exist:!0,func:"creatVolBar",colour:"#007491",layer:1},background:{colour:"#1f4c60"}},indicator:{movingAverage5d:{exist:!0,func:"creatMovAv5d",colour:"#20677d",layer:5},movingAverage20d:{exist:!0,func:"creatMovAv20d",colour:"#a87515",layer:6},donchianChannel:{exist:!0,colour:"#2a2a31",func:"creatDonchian",layer:0}}},r={average:{de:"durchschnittlich","en-us":"average",fr:"moyenne",ja:"平均",ru:"средний",zh:"平均"},background:{de:"Hintergrund ","en-us":"background ",fr:"arrière plan ",ja:"バックグラウンド ",ru:"фон ",zh:"背景 "},bar:{de:"Bar","en-us":"bar",fr:"bar",ja:"バー",ru:"бар",zh:"酒吧"},chart:{de:"Diagramm","en-us":"chart",fr:"graphique",ja:"チャート",ru:"диаграмма",zh:"图表"},date:{de:"Datum","en-us":"date",fr:"date",ja:"日付",ru:"Дата",zh:"日期"},donchianChannel:{de:"Donchian Channel","en-us":"donchian channel",fr:"canal de Donchian",ja:"ドンチアンチャンネル",ru:"канал Дончиана",zh:"donchian频道"},high:{de:"hoch ","en-us":"high ",fr:"haut ",ja:"高い ",ru:"высоко ",zh:"高 "},highest:{de:"höchste","en-us":"highest",fr:"plus haut",ja:"最高",ru:"наибольший",zh:"最高"},indicator:{de:"Indikator","en-us":"indicator",fr:"indicateur",ja:"インジケータ",ru:"индикатор",zh:"指示符"},line:{de:"Linie","en-us":"line",fr:"ligne",ja:"ライン",ru:"линия",zh:"线"},low:{de:"niedrig ","en-us":"low ",fr:"bas ",ja:"低い ",ru:"низкий ",zh:"低 "},lowest:{de:"niedrigste","en-us":"lowest",fr:"plus bas",ja:"最低",ru:"низший",zh:"最低"},movingAverage20d:{de:"gleitender Durchschnitt 20 Tage","en-us":"moving average 20 day",fr:"moyenne mobile 20 jours",ja:"移動平均20日間",ru:"скользящая средняя 20 дней",zh:"移动平均20天"},movingAverage5d:{de:"gleitender Durchschnitt 5 Tage","en-us":"moving average 5 day",fr:"moyenne mobile 5 jours",ja:"移動平均5日間",ru:"скользящая средняя 5 дней",zh:"移动平均5天"},options_message:{de:"Klicken Sie erneut auf das Zahnrad, um diese Option zu schließen","en-us":"click again on the gear wheel to close this option tab",fr:"cliquez à nouveau sur la roue dentée pour fermer cet onglet d'options",ja:"歯車をもう一度クリックしてこのオプションタブを閉じます",ru:"снова нажмите на шестерню, чтобы закрыть эту вкладку",zh:"再次单击齿轮以关闭此选项选项卡"},order_count:{de:"Auftragszählung","en-us":"order count",fr:"nombre de commandes",ja:"注文数",ru:"количество заказов",zh:"订单数量"},reset_option:{de:"Option zurücksetzen","en-us":"reset option",fr:"réinitialiser les options",ja:"リセットオプション",ru:"опция сброса",zh:"重置选项"},volume:{de:"Volumen","en-us":"volume",fr:"le volume",ja:"ボリューム",ru:"объем",zh:"体积"}},o=function(){function e(){this.defaultOptions=a,this.translation=r}return e.prototype.setOptionSpace=function(e){this.lang=e.lang;var t=this.creatElement("div",{id:"optionSpace"},{"z-index":2,position:"absolute","text-align":"center","border-radius":"2%",opacity:"0.9",width:"50%",height:"300px",top:"5%",right:"5%","background-color":"#353b44",color:"white","font-size":"100%"});document.getElementById("supercontenaire").insertAdjacentElement("afterbegin",t),this.setOptionContent(e,t)},e.prototype.setOptionContent=function(e,t){var i=this;for(var n in t.appendChild(this.creatElement("p",void 0,void 0,this.translation.options_message[this.lang])),e.options){var a=void 0;(a="chart"===n?this.creatElement("div",{id:n},{"z-index":2,"text-align":"right",right:"0px",width:"50%",position:"absolute"}):this.creatElement("div",{id:n},{"z-index":2,"text-align":"right",width:"50%",position:"absolute"})).appendChild(this.creatElement("h3",void 0,{"text-align":"center"},this.translation[n][this.lang])),a.appendChild(this.displayOptions(e.options[n])),a.addEventListener("change",function(t){return i.setPreference(t,e)}),document.getElementById("optionSpace").appendChild(a)}var r=this.creatElement("button",{type:"reset",id:"resetButton"},{"z-index":2,bottom:"3%",position:"inherit",right:"42%",width:"100px"},this.translation.reset_option[this.lang]);t.appendChild(r),r.addEventListener("click",function(){return i.resetPreference(e)})},e.prototype.displayOptions=function(e){var t=document.createElement("div");for(var i in e){var n=document.createElement("div");switch(i){case"bar":n.appendChild(this.creatElement("label",{for:i},void 0,this.translation[i][this.lang])),n.appendChild(this.creatElement("input",{type:"checkbox",id:"check",name:i,checked:e[i].exist})),n.appendChild(this.creatElement("label",{for:"colour"},void 0,this.translation.high[this.lang])),n.appendChild(this.creatElement("input",{type:"color",id:"colour.higher",name:i,value:e[i].colour.higher}));var a=document.createElement("div");a.appendChild(this.creatElement("label",{for:"colour"},void 0,this.translation.low[this.lang])),a.appendChild(this.creatElement("input",{type:"color",id:"colour.lower",name:i,value:e[i].colour.lower})),n.appendChild(a),t.appendChild(n);break;case"background":n.appendChild(this.creatElement("label",{for:i},void 0,this.translation[i][this.lang])),n.appendChild(this.creatElement("label",{for:"colour"})),n.appendChild(this.creatElement("input",{type:"color",id:"colour",name:i,value:e[i].colour})),t.appendChild(n);break;default:n.appendChild(this.creatElement("label",{for:i},void 0,this.translation[i][this.lang])),n.appendChild(this.creatElement("input",{type:"checkbox",id:"check",name:i,checked:e[i].exist})),n.appendChild(this.creatElement("input",{type:"color",id:"colour",name:i,value:e[i].colour})),t.appendChild(n)}}return t},e.prototype.creatElement=function(e,t,i,n){var a=document.createElement(e);for(var r in t)a.setAttribute(r,t[r]);for(var r in i)a.style[r]=i[r];return void 0!==n&&a.appendChild(document.createTextNode(n)),a},e.prototype.closeOptionSpace=function(){var e=document.getElementById("optionSpace");e.parentNode.removeChild(e)},e.prototype.setPreference=function(e,t){var i,n,a,r;if(e.target.focus(),a=(i=e.currentTarget.id)+"."+(n=e.target.name)+"."+e.target.id,"check"===e.target.id){t.options[i][n].exist=e.target.checked;var o=i+"."+n+".exist";r=e.target.checked,this.setCookie(o,r),t.displayChart(t.data)}else r=e.target.value,t.setObjValue(a.split("."),e.target.value,t.options),this.setCookie(a,r),t.displayChart(t.data)},e.prototype.setCookie=function(e,t){var i=this.parseCookie();i.userChartPreference?i.userChartPreference[e]=t:(i.userChartPreference={},i.userChartPreference[e]=t),document.cookie="userChartPreference="+JSON.stringify(i.userChartPreference)+";max-age=31536000;path=/"},e.prototype.parseCookie=function(){for(var e={},t=document.cookie.split("; "),i=t.length,n=0;n<i;n++){var a=t[n].split("=");"userChartPreference"===a[0]&&(e[a[0]]=JSON.parse(a[1]))}return e},e.prototype.resetPreference=function(e){e.options=e.deepCopyObject(this.defaultOptions),document.cookie="userChartPreference=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/";var t=document.getElementById("optionSpace");t.innerHTML="",this.setOptionContent(e,t),e.displayChart(e.data)},e}();window.chartlib_canvas=function(e,t){new s(new n,new o).init(e,t)};var s=function(){function e(e,t){var i=this;this.shapeCreator=e,this.userPreference=t,this.translation=r,this.options={},this.isMobile=!1,this.openOptionBox=!1,this.renderObj={},this.zoom=1,this.click=!1,this.pan=0,this.offset=0,this.currentDataPosition=0,this.setObjValue=function(e,t,n){return e.length>1?n&&n[e[0]]?i.setObjValue(e.slice(1),t,n[e[0]]):void 0:(n[e[0]]=t,!0)}}return e.prototype.init=function(e,t){var i=this;this.options=this.deepCopyObject(a),this.cursorDebug=document.getElementById("cursorDebug"),this.data=e,this.dataLength=e.length,this.lang=t,this.isMobile=void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile");var n=this.userPreference.parseCookie();for(var r in n.userChartPreference){var o=r.split(".");this.setObjValue(o,n.userChartPreference[r],this.options)}this.contenaire=document.getElementById("supercontenaire"),this.createCanvas(),this.setSpace(),this.preRender(),this.displayChart(e),this.contenaire.addEventListener("mousemove",function(e){return i.handleCursor(e)}),this.contenaire.addEventListener("touchstart",function(e){return i.handleTouch(e)}),this.contenaire.addEventListener("touchmove",function(e){return i.handleTouch(e)}),this.contenaire.addEventListener("wheel",function(e){return i.wheelHandler(e)}),this.contenaire.addEventListener("mousedown",function(){return i.click=!i.click}),this.contenaire.addEventListener("mouseup",function(){return i.click=!1}),this.contenaire.addEventListener("mouseleave",function(){document.body.style.cursor="default",!0===i.click&&(i.click=!1)}),this.contenaire.addEventListener("click",function(e){return i.optionWheelClicked(e)}),window.addEventListener("resize",function e(){null!==document.getElementById("supercontenaire")?(this.setSpace(),this.displayChart(this.data)):window.removeEventListener("resize",e)}.bind(this))},e.prototype.optionWheelClicked=function(e){if(!this.openOptionBox&&this.optionWheel.contains(e.target))this.openOptionBox=!this.openOptionBox,this.userPreference.setOptionSpace(this);else if(this.openOptionBox){!document.getElementById("optionSpace").contains(e.target)&&this.openOptionBox&&"resetButton"!==e.target.id&&(this.openOptionBox=!this.openOptionBox,this.userPreference.closeOptionSpace())}},e.prototype.createCanvas=function(){for(var e=["upperText_canvas","displayPrices_canvas","main_canvas","cursor_canvas"],t=new Array(4),i=0;i<4;i++)t[i]=document.createElement("canvas"),t[i].className="canvas",t[i].style.position="absolute",t[i].style.left="0px",t[i].style.top="0px",t[i].id=e[i],this[e[i]]=t[i],this.contenaire.appendChild(t[i]);var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"width","24"),n.setAttributeNS(null,"height","24"),n.setAttributeNS(null,"id","wheelimg"),n.setAttributeNS(null,"position","absolute"),n.setAttributeNS(null,"viewBox","0 0 24 24"),n.setAttributeNS(null,"z-index","10");var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M19.44 12.99l-.01.02c.04-.33.08-.67.08-1.01 0-.34-.03-.66-.07-.99l.01.02 2.44-1.92-2.43-4.22-2.87 1.16.01.01c-.52-.4-1.09-.74-1.71-1h.01L14.44 2H9.57l-.44 3.07h.01c-.62.26-1.19.6-1.71 1l.01-.01-2.88-1.17-2.44 4.22 2.44 1.92.01-.02c-.04.33-.07.65-.07.99 0 .34.03.68.08 1.01l-.01-.02-2.1 1.65-.33.26 2.43 4.2 2.88-1.15-.02-.04c.53.41 1.1.75 1.73 1.01h-.03L9.58 22h4.85s.03-.18.06-.42l.38-2.65h-.01c.62-.26 1.2-.6 1.73-1.01l-.02.04 2.88 1.15 2.43-4.2s-.14-.12-.33-.26l-2.11-1.66zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"),n.appendChild(a),this.optionWheel=n,this.contenaire.appendChild(n),this.optionWheel.setAttributeNS(null,"transform","rotate(0)"),this.upperText_ctx=this.upperText_canvas.getContext("2d"),this.displayPrices_ctx=this.displayPrices_canvas.getContext("2d"),this.main_ctx=this.main_canvas.getContext("2d"),this.cursor_ctx=this.cursor_canvas.getContext("2d")},e.prototype.preRender=function(){for(var e in this.options.chart){if("background"!==e)if("bar"===e)for(var t in this.options.chart[e].colour){(i=document.createElement("canvas")).width=this.width,i.height=this.height,this.renderObj[""+e+t]=i}else(i=document.createElement("canvas")).width=this.width,i.height=this.height,this.renderObj[e]=i}for(var e in this.options.indicator){var i;(i=document.createElement("canvas")).width=this.width,i.height=this.height,this.renderObj[e]=i}},e.prototype.setSpace=function(){var e=document.getElementById("supercontenaire");this.contenaireRect=e.getBoundingClientRect(),this.height=e.clientHeight,this.width=e.clientWidth,this.Y_upperTextSpace=.03*this.height,this.Y_mainSpace=.85*this.height,this.Y_volumeSpace=.12*this.height,this.X_priceSpace=.045*e.clientWidth,this.X_chartSpace=e.clientWidth-.045*e.clientWidth,this.baseInterval=(e.clientWidth-this.X_priceSpace)/this.dataLength,this.dataGap=this.baseInterval-this.baseInterval/5,document.getElementById("wheelimg").style.marginLeft=e.clientWidth-24+"px",this.upperText_canvas.width=e.clientWidth,this.upperText_canvas.height=e.clientHeight,this.displayPrices_canvas.width=e.clientWidth,this.displayPrices_canvas.height=e.clientHeight,this.main_canvas.width=e.clientWidth,this.main_canvas.height=e.clientHeight,this.cursor_canvas.width=e.clientWidth,this.cursor_canvas.height=e.clientHeight},e.prototype.displayChart=function(e){var t=0,i=0,n={lastLow:e[0].lowest,lastLowIndex:0,lastHigh:e[0].highest,lastHighIndex:0};this.shapeCreator.changeBackground(this.options.chart.background.colour);var a=this.X_priceSpace,r=this.baseInterval*this.zoom,o=a+r,s=this.pan>0?Math.floor(this.pan/r):0;s=s>this.dataLength-1?this.dataLength-1:s;var h=Math.floor(this.width/r+this.pan/r);h=h>this.dataLength-1?this.dataLength-1:h;var c=this.setVerticalScale(e,s,h);for(var l in this.displayPrices(c),this.renderObj)this.renderObj[l].getContext("2d").clearRect(0,0,this.width,this.height),this.renderObj[l].getContext("2d").beginPath();this.main_ctx.clearRect(0,0,this.width,this.height),this.main_ctx.beginPath();for(var d=0;d<this.dataLength;d++){t+=e[d].average,i+=e[d].average,n.lastLow>e[d].lowest&&(n.lastLow=e[d].lowest,n.lastLowIndex=d),n.lastHigh<e[d].highest&&(n.lastHigh=e[d].highest,n.lastHighIndex=d),d>=5&&(t-=e[d-5].average),d>=20&&(i-=e[d-20].average),this.main_ctx.globalAlpha=1;var p={movingAverage5d:t,movingAverage20d:i,donchianChannel:n},u=a-this.pan,g=o-this.pan;if(u>=this.X_priceSpace&&u<this.width){for(var l in this.options.chart){var v=this.options.chart[l].colour;if(this.options.chart[l].hasOwnProperty("func")&&this.options.chart[l].exist){var f=this.options.chart[l].func;this.shapeCreator[f](this,l,u,g,c,d,v)}}for(var l in this.options.indicator){v=this.options.indicator[l].colour;if(this.options.indicator[l].hasOwnProperty("func")&&this.options.indicator[l].exist&&d<this.dataLength-1){f=this.options.indicator[l].func;this.shapeCreator[f](this,l,u,g,p[l],c,d,v)}}}o+=r,a+=r}var m=new Array(Object.keys(this.renderObj).length-1);for(var l in this.renderObj)if("donchianChannel"===l){this.renderObj[l].getContext("2d").closePath(),this.renderObj[l].getContext("2d").fill(),m[x=this.options.indicator[l].layer]=this.renderObj[l]}else{if("bar"===l.substr(0,3)){void 0===m[x=this.options.chart.bar.layer]?m[x]=this.renderObj[l]:m[x+1]=this.renderObj[l]}else{var x,b=this.options.chart[l]?"chart":"indicator";m[x=this.options[b][l].layer]=this.renderObj[l]}this.renderObj[l].getContext("2d").closePath(),this.renderObj[l].getContext("2d").stroke(),this.renderObj[l].getContext("2d").fill()}for(d=0;d<m.length;d++)this.main_ctx.drawImage(m[d],0,0)},e.prototype.setVerticalScale=function(e,t,i){var n,a,r,o;for(n=e[t].lowest,a=e[t].highest,r=e[t].volume,o=e[t].volume;t<i;)t<0||(n>e[t].lowest&&(n=e[t].lowest),a<e[t].highest&&(a=e[t].highest),r>e[t].volume&&(r=e[t].volume),o<e[t].volume&&(o=e[t].volume),t++);return{lowestPrice:n,highestPrice:a,lowestVolume:r,highestVolume:o}},e.prototype.displayPrices=function(e){var t,i,n=e.highestPrice-e.lowestPrice;t=e.lowestPrice,this.displayPrices_ctx.clearRect(0,0,this.width,this.height);for(var a=0;a<5;a++)t+=Math.round(n/6),t=this.preciseRound(t,2),i=this.Y_upperTextSpace+this.Y_mainSpace*(1-(t-e.lowestPrice)/n),this.displayPrices_ctx.fillText(t.toString(),0,i),this.displayPrices_ctx.beginPath(),this.displayPrices_ctx.strokeStyle="rgba(0,0,0,0.4)",this.displayPrices_ctx.setLineDash([5,15]),this.displayPrices_ctx.moveTo(this.X_priceSpace,i-3.5),this.displayPrices_ctx.lineTo(this.width,i-3.5),this.displayPrices_ctx.stroke(),this.displayPrices_ctx.fillStyle="rgb(0, 0, 0)",this.displayPrices_ctx.stroke()},e.prototype.handleCursor=function(e){e.preventDefault(),!0===this.click?this.panHandler(e):this.offset=0,this.moveGraph(e.clientX,e.clientY)},e.prototype.handleTouch=function(e){var t=e.target;if("wheelimg"!==t.id&&"wheelimg"!==t.parentNode.id&&!this.openOptionBox){e.preventDefault();var i=e.touches.length;if(1===i)"touchmove"===e.type?this.panHandler(e.touches[0]):this.offset=0,this.moveGraph(e.touches[0].clientX,e.touches[0].clientY);else if(2===i&&"touchstart"===e.type){var n=e.touches[0].clientX,a=e.touches[1].clientX,r=e.touches[0].clientX/e.touches[0].clientY,o=e.touches[1].clientX/e.touches[1].clientY;this.lastDeltaDiff=r>o?r-o:o-r;var s=this.dataGap*this.zoom/2,h=this.baseInterval*this.zoom,c=n>a?a+(n-a)/2:n+(a-n)/2;this.pinchZoomDataPosition=Math.round((c-this.contenaireRect.left-this.X_priceSpace-s)/h+this.pan/h)}else if(2===i&&"touchmove"===e.type){var l=(r=e.touches[0].clientX/e.touches[0].clientY)>(o=e.touches[1].clientX/e.touches[1].clientY)?r-o:o-r,d=this.zoom*this.baseInterval;l>this.lastDeltaDiff+this.lastDeltaDiff/15&&this.zoom<16?(this.lastDeltaDiff=l,this.zoom=this.preciseRound(1.2*this.zoom,2),this.pan+=(this.zoom*this.baseInterval-d)*this.pinchZoomDataPosition):l<this.lastDeltaDiff-this.lastDeltaDiff/15&&this.zoom>1&&(this.lastDeltaDiff=l,this.zoom=this.preciseRound(this.zoom/1.2,2),this.pan+=(this.zoom*this.baseInterval-d)*this.pinchZoomDataPosition),this.preventOutOfScreen(),this.displayChart(this.data)}}},e.prototype.moveGraph=function(e,t){var i=document.getElementById("supercontenaire").getBoundingClientRect(),n=this.baseInterval*this.zoom,a=this.dataGap*this.zoom/2,r=Math.round((e-this.contenaireRect.left-this.X_priceSpace-a)/n+this.pan/n);this.currentDataPosition=r;var o=n*r-this.pan,s=t-i.top;this.cursor_ctx.clearRect(0,0,this.width,this.height),o>0&&t>this.Y_upperTextSpace&&(document.body.style.cursor="crosshair",this.cursor_ctx.fillStyle="rgb(255, 0, 0)",this.cursor_ctx.fillRect(o+this.X_priceSpace+a,this.Y_upperTextSpace,1,this.height),this.cursor_ctx.fillRect(this.X_priceSpace,s,this.width,1)),r>=0&&r<this.dataLength&&this.displayData(this.data[r])},e.prototype.displayData=function(e){this.upperText_ctx.clearRect(0,0,this.width,this.height),this.upperText_ctx.font="13px sans serif",this.upperText_ctx.fillText(this.translation.date[this.lang]+": "+e.date+", "+this.translation.average[this.lang]+": "+e.average+", "+this.translation.highest[this.lang]+": "+e.highest+", "+this.translation.lowest[this.lang]+": "+e.lowest+", "+this.translation.volume[this.lang]+": "+e.volume+", "+this.translation.order_count[this.lang]+": "+e.order_count,5,12,this.width-30)},e.prototype.wheelHandler=function(e){e.preventDefault();var t=this.zoom*this.baseInterval;e.deltaY<0&&this.zoom<16?(this.zoom=this.preciseRound(1.2*this.zoom,2),this.pan+=(this.zoom*this.baseInterval-t)*this.currentDataPosition):e.deltaY>0&&this.zoom>1&&(this.zoom=this.preciseRound(this.zoom/1.2,2),this.pan+=(this.zoom*this.baseInterval-t)*this.currentDataPosition),this.preventOutOfScreen(),this.displayChart(this.data)},e.prototype.panHandler=function(e){0===this.offset?this.offset=e.clientX:(this.pan+=this.offset-e.clientX,this.offset=e.clientX),this.preventOutOfScreen(),this.displayChart(this.data)},e.prototype.preventOutOfScreen=function(){this.pan=this.pan<=-this.X_chartSpace/2?this.pan=-this.X_chartSpace/2:this.pan,this.pan=this.pan>=this.X_chartSpace*this.zoom-this.X_chartSpace/2?this.pan=this.X_chartSpace*this.zoom-this.X_chartSpace/2:this.pan},e.prototype.preciseRound=function(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i},e.prototype.deepCopyObject=function(e,t){for(var i in void 0===t&&(t={}),e)"object"==typeof e[i]?(t[i]={},this.deepCopyObject(e[i],t[i])):t[i]=e[i];return t},e}()}]);